<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register - PinjamSarana</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --secondary-gradient: linear-gradient(45deg, #ffd700, #ffed4e);
      --primary-color: #667eea;
      --secondary-color: #764ba2;
      --accent-color: #ffd700;
      --text-dark: #333;
      --text-light: #666;
      --text-muted: #95a5a6;
      --white: #ffffff;
      --border-color: #e1e5e9;
      --success-color: #27ae60;
      --error-color: #e74c3c;
      --warning-color: #f39c12;
      --info-color: #3498db;
      --shadow-sm: 0 2px 10px rgba(0,0,0,0.1);
      --shadow-md: 0 10px 30px rgba(0,0,0,0.1);
      --shadow-lg: 0 20px 40px rgba(0,0,0,0.15);
      --transition: all 0.3s ease;
      --border-radius-sm: 8px;
      --border-radius-md: 12px;
      --border-radius-lg: 15px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: var(--primary-gradient);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="rgba(255,255,255,0.05)"><polygon points="1000,100 1000,0 0,100"/></svg>');
      background-size: cover;
      z-index: 0;
    }

    .register-container {
      background: var(--white);
      padding: 2.5rem;
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-lg);
      width: 100%;
      max-width: 500px;
      text-align: center;
      position: relative;
      z-index: 1;
      backdrop-filter: blur(10px);
    }

    .logo {
      margin-bottom: 2rem;
    }

    .logo h1 {
      color: var(--text-dark);
      font-size: clamp(1.5rem, 4vw, 1.8rem);
      margin-bottom: 0.5rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .logo i {
      font-size: 2rem;
      background: var(--primary-gradient);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .logo p {
      color: var(--text-light);
      font-size: clamp(0.8rem, 2vw, 0.9rem);
      font-weight: 400;
    }

    .form-group {
      margin-bottom: 1.5rem;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      color: var(--text-dark);
      font-weight: 500;
      font-size: 0.9rem;
    }

    .input-wrapper {
      position: relative;
    }

    .form-control {
      width: 100%;
      padding: 0.875rem 1rem;
      padding-left: 3rem;
      border: 2px solid var(--border-color);
      border-radius: var(--border-radius-sm);
      font-size: 1rem;
      font-family: inherit;
      transition: var(--transition);
      background: var(--white);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .form-control::placeholder {
      color: var(--text-muted);
    }

    .form-control.valid {
      border-color: var(--success-color);
    }

    .form-control.invalid {
      border-color: var(--error-color);
    }

    .input-icon {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-light);
      font-size: 1rem;
    }

    .validation-icon {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1rem;
      opacity: 0;
      transition: var(--transition);
    }

    .validation-icon.valid {
      color: var(--success-color);
      opacity: 1;
    }

    .validation-icon.invalid {
      color: var(--error-color);
      opacity: 1;
    }

    .btn {
      width: 100%;
      padding: 0.875rem 1.5rem;
      background: var(--primary-gradient);
      color: var(--white);
      border: none;
      border-radius: var(--border-radius-sm);
      font-size: 1rem;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      transition: var(--transition);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .btn-loading {
      position: relative;
    }

    .btn-loading::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      border: 2px solid transparent;
      border-top: 2px solid var(--white);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .alert {
      padding: 0.875rem 1rem;
      border-radius: var(--border-radius-sm);
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .alert-error {
      background-color: rgba(231, 76, 60, 0.1);
      color: var(--error-color);
      border: 1px solid rgba(231, 76, 60, 0.2);
    }

    .alert-success {
      background-color: rgba(39, 174, 96, 0.1);
      color: var(--success-color);
      border: 1px solid rgba(39, 174, 96, 0.2);
    }

    .alert-warning {
      background-color: rgba(243, 156, 18, 0.1);
      color: var(--warning-color);
      border: 1px solid rgba(243, 156, 18, 0.2);
    }

    .divider {
      margin: 1.5rem 0;
      position: relative;
      text-align: center;
    }

    .divider::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 1px;
      background: var(--border-color);
    }

    .divider span {
      background: var(--white);
      padding: 0 1rem;
      color: var(--text-light);
      font-size: 0.9rem;
    }

    .link {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
    }

    .link:hover {
      color: var(--secondary-color);
      text-decoration: underline;
    }

    .password-requirements {
      background: rgba(52, 152, 219, 0.05);
      border: 1px solid rgba(52, 152, 219, 0.1);
      padding: 1rem;
      border-radius: var(--border-radius-sm);
      margin-bottom: 1.5rem;
      font-size: 0.85rem;
      text-align: left;
      transition: var(--transition);
    }

    .password-requirements h4 {
      margin-bottom: 0.75rem;
      color: var(--text-dark);
      font-size: 0.9rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .password-requirements ul {
      margin-left: 1rem;
      color: var(--text-light);
      line-height: 1.5;
    }

    .password-requirements li {
      margin: 0.25rem 0;
    }

    .requirement-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin: 0.5rem 0;
    }

    .requirement-item i {
      font-size: 0.8rem;
      width: 12px;
    }

    .requirement-item.valid i {
      color: var(--success-color);
    }

    .requirement-item.invalid i {
      color: var(--error-color);
    }

    .back-link {
      position: absolute;
      top: 1.5rem;
      left: 1.5rem;
      color: var(--white);
      text-decoration: none;
      font-size: 1.5rem;
      transition: var(--transition);
      z-index: 2;
    }

    .back-link:hover {
      color: var(--accent-color);
      transform: translateX(-3px);
    }

    .footer-links {
      margin-top: 1.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border-color);
    }

    .footer-links p {
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      color: var(--text-light);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      body {
        padding: 15px;
      }

      .register-container {
        padding: 2rem 1.5rem;
        max-width: 100%;
      }

      .back-link {
        top: 1rem;
        left: 1rem;
      }

      .password-requirements {
        padding: 0.875rem;
        font-size: 0.8rem;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }

      .register-container {
        padding: 1.5rem 1rem;
      }

      .logo h1 {
        font-size: 1.5rem;
      }

      .form-control {
        padding: 0.75rem 0.875rem;
        padding-left: 2.75rem;
        font-size: 0.95rem;
      }

      .input-icon {
        left: 0.875rem;
        font-size: 0.9rem;
      }

      .validation-icon {
        right: 0.875rem;
      }

      .btn {
        padding: 0.75rem 1.25rem;
        font-size: 0.95rem;
      }

      .password-requirements h4 {
        font-size: 0.85rem;
      }
    }

    @media (max-width: 360px) {
      .register-container {
        padding: 1.25rem 0.75rem;
      }

      .form-group {
        margin-bottom: 1.25rem;
      }

      .divider {
        margin: 1.25rem 0;
      }
    }
  </style>
</head>
<body>
  <a href="login.html" class="back-link" title="Kembali ke Login">
    <i class="fas fa-arrow-left"></i>
  </a>

  <div class="register-container">
    <div class="logo">
      <h1><i class="fas fa-user-plus"></i> PinjamSarana</h1>
      <p>Daftar Akun User Baru</p>
    </div>

    <div id="alertContainer"></div>

    <form id="registerForm">
      <div class="form-group">
        <label for="name">Nama Lengkap</label>
        <div class="input-wrapper">
          <i class="fas fa-user input-icon"></i>
          <input type="text" id="name" class="form-control" required placeholder="Masukkan nama lengkap" autocomplete="name">
          <i class="validation-icon" id="nameValidation"></i>
        </div>
      </div>

      <div class="form-group">
        <label for="username">Username</label>
        <div class="input-wrapper">
          <i class="fas fa-at input-icon"></i>
          <input type="text" id="username" class="form-control" required placeholder="Masukkan username" autocomplete="username">
          <i class="validation-icon" id="usernameValidation"></i>
        </div>
      </div>

      <div class="form-group">
        <label for="email">Email</label>
        <div class="input-wrapper">
          <i class="fas fa-envelope input-icon"></i>
          <input type="email" id="email" class="form-control" required placeholder="Masukkan email" autocomplete="email">
          <i class="validation-icon" id="emailValidation"></i>
        </div>
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <div class="input-wrapper">
          <i class="fas fa-lock input-icon"></i>
          <input type="password" id="password" class="form-control" required placeholder="Masukkan password" autocomplete="new-password">
          <i class="validation-icon" id="passwordValidation"></i>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Konfirmasi Password</label>
        <div class="input-wrapper">
          <i class="fas fa-lock input-icon"></i>
          <input type="password" id="confirmPassword" class="form-control" required placeholder="Konfirmasi password" autocomplete="new-password">
          <i class="validation-icon" id="confirmPasswordValidation"></i>
        </div>
      </div>

      <div class="password-requirements" id="passwordRequirements">
        <h4><i class="fas fa-info-circle"></i> Persyaratan Password:</h4>
        <div class="requirement-item" id="lengthReq">
          <i class="fas fa-times"></i>
          <span>Minimal 6 karakter</span>
        </div>
        <div class="requirement-item" id="alphanumericReq">
          <i class="fas fa-times"></i>
          <span>Mengandung huruf dan angka</span>
        </div>
        <div class="requirement-item" id="matchReq">
          <i class="fas fa-times"></i>
          <span>Password harus sama dengan konfirmasi</span>
        </div>
      </div>

      <button type="submit" class="btn" id="registerBtn">
        <i class="fas fa-user-plus"></i>
        <span>Daftar Sekarang</span>
      </button>
    </form>

    <div class="footer-links">
      <div class="divider">
        <span>atau</span>
      </div>
      <p>Sudah punya akun? <a href="login.html" class="link">Masuk di sini</a></p>
    </div>
  </div>

  <script>
    // Show alert function
    function showAlert(message, type = 'error') {
      const alertContainer = document.getElementById('alertContainer');
      const iconMap = {
        error: 'fas fa-exclamation-circle',
        success: 'fas fa-check-circle',
        warning: 'fas fa-exclamation-triangle',
        info: 'fas fa-info-circle'
      };
      
      alertContainer.innerHTML = `
        <div class="alert alert-${type}">
          <i class="${iconMap[type]}"></i>
          ${message}
        </div>
      `;
      
      setTimeout(() => {
        alertContainer.innerHTML = '';
      }, 5000);
    }

    // Validation functions
    function isValidEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }

    function isValidPassword(password) {
      const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{6,}$/;
      return passwordRegex.test(password);
    }

    function isValidUsername(username) {
      const usernameRegex = /^[a-zA-Z0-9_]{3,20}$/;
      return usernameRegex.test(username);
    }

    function isValidName(name) {
      return name.length >= 2 && name.length <= 50;
    }

    // Update validation UI
    function updateValidation(inputId, isValid) {
      const input = document.getElementById(inputId);
      const validation = document.getElementById(inputId + 'Validation');
      
      input.classList.remove('valid', 'invalid');
      validation.classList.remove('valid', 'invalid');
      
      if (input.value.length > 0) {
        if (isValid) {
          input.classList.add('valid');
          validation.classList.add('valid');
          validation.className = 'validation-icon valid fas fa-check';
        } else {
          input.classList.add('invalid');
          validation.classList.add('invalid');
          validation.className = 'validation-icon invalid fas fa-times';
        }
      }
    }

    // Update password requirements
    function updatePasswordRequirements(password, confirmPassword) {
      const lengthReq = document.getElementById('lengthReq');
      const alphanumericReq = document.getElementById('alphanumericReq');
      const matchReq = document.getElementById('matchReq');
      
      // Length requirement
      if (password.length >= 6) {
        lengthReq.classList.add('valid');
        lengthReq.classList.remove('invalid');
        lengthReq.querySelector('i').className = 'fas fa-check';
      } else {
        lengthReq.classList.add('invalid');
        lengthReq.classList.remove('valid');
        lengthReq.querySelector('i').className = 'fas fa-times';
      }
      
      // Alphanumeric requirement
      if (/^(?=.*[A-Za-z])(?=.*\d)/.test(password)) {
        alphanumericReq.classList.add('valid');
        alphanumericReq.classList.remove('invalid');
        alphanumericReq.querySelector('i').className = 'fas fa-check';
      } else {
        alphanumericReq.classList.add('invalid');
        alphanumericReq.classList.remove('valid');
        alphanumericReq.querySelector('i').className = 'fas fa-times';
      }
      
      // Match requirement
      if (password === confirmPassword && password.length > 0) {
        matchReq.classList.add('valid');
        matchReq.classList.remove('invalid');
        matchReq.querySelector('i').className = 'fas fa-check';
      } else {
        matchReq.classList.add('invalid');
        matchReq.classList.remove('valid');
        matchReq.querySelector('i').className = 'fas fa-times';
      }
    }

    // Register function
    function register(userData) {
      let users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
      
      // Check if username already exists
      const existingUser = users.find(u => u.username === userData.username);
      if (existingUser) {
        showAlert('Username sudah digunakan! Silakan pilih username lain.');
        return false;
      }

      // Check if email already exists
      const existingEmail = users.find(u => u.email === userData.email);
      if (existingEmail) {
        showAlert('Email sudah terdaftar! Silakan gunakan email lain.');
        return false;
      }

      // Check if username is 'admin' (reserved)
      if (userData.username.toLowerCase() === 'admin') {
        showAlert('Username "admin" tidak dapat digunakan karena sudah reserved untuk administrator.');
        return false;
      }
      
      // Generate new ID
      const newId = users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1;
      
      // Add new user
      const newUser = {
        id: newId,
        name: userData.name,
        username: userData.username,
        email: userData.email,
        password: userData.password,
        role: 'user',
        createdAt: new Date().toISOString()
      };
      
      users.push(newUser);
      localStorage.setItem('registeredUsers', JSON.stringify(users));
      
      showAlert(`Pendaftaran berhasil! Selamat datang, ${userData.name}!`, 'success');
      
      // Redirect to login after 2 seconds
      setTimeout(() => {
        window.location.href = 'login.html';
      }, 2000);
      
      return true;
    }

    // Real-time validation
    document.getElementById('name').addEventListener('input', function() {
      updateValidation('name', isValidName(this.value));
    });

    document.getElementById('username').addEventListener('input', function() {
      const isValid = isValidUsername(this.value) && this.value.toLowerCase() !== 'admin';
      updateValidation('username', isValid);
      
      if (this.value.toLowerCase() === 'admin') {
        showAlert('Username "admin" tidak dapat digunakan!', 'warning');
      }
    });

    document.getElementById('email').addEventListener('input', function() {
      updateValidation('email', isValidEmail(this.value));
    });

    document.getElementById('password').addEventListener('input', function() {
      const password = this.value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      updateValidation('password', isValidPassword(password));
      updatePasswordRequirements(password, confirmPassword);
      
      if (confirmPassword) {
        updateValidation('confirmPassword', password === confirmPassword);
      }
    });

    document.getElementById('confirmPassword').addEventListener('input', function() {
      const password = document.getElementById('password').value;
      const confirmPassword = this.value;
      
      updateValidation('confirmPassword', password === confirmPassword);
      updatePasswordRequirements(password, confirmPassword);
    });

    // Handle form submit
    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const registerBtn = document.getElementById('registerBtn');
      const btnText = registerBtn.querySelector('span');
      const btnIcon = registerBtn.querySelector('i');
      
      registerBtn.disabled = true;
      registerBtn.classList.add('btn-loading');
      btnText.textContent = 'Memproses...';
      btnIcon.style.display = 'none';
      
      const name = document.getElementById('name').value.trim();
      const username = document.getElementById('username').value.trim();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      // Validation
      if (!name || !username || !email || !password || !confirmPassword) {
        showAlert('Mohon isi semua field!', 'warning');
        resetRegisterButton();
        return;
      }
      
      if (!isValidName(name)) {
        showAlert('Nama harus minimal 2 karakter dan maksimal 50 karakter!');
        resetRegisterButton();
        return;
      }

      if (!isValidUsername(username)) {
        showAlert('Username harus 3-20 karakter dan hanya boleh mengandung huruf, angka, dan underscore!');
        resetRegisterButton();
        return;
      }
      
      if (!isValidEmail(email)) {
        showAlert('Format email tidak valid!');
        resetRegisterButton();
        return;
      }
      
      if (!isValidPassword(password)) {
        showAlert('Password harus minimal 6 karakter dan mengandung huruf serta angka!');
        resetRegisterButton();
        return;
      }
      
      if (password !== confirmPassword) {
        showAlert('Password dan konfirmasi password tidak sama!');
        resetRegisterButton();
        return;
      }
      
      // Simulate processing time
      setTimeout(() => {
        register({
          name: name,
          username: username,
          email: email,
          password: password
        });
        
        resetRegisterButton();
      }, 1000);
    });

    function resetRegisterButton() {
      const registerBtn = document.getElementById('registerBtn');
      const btnText = registerBtn.querySelector('span');
      const btnIcon = registerBtn.querySelector('i');
      
      registerBtn.disabled = false;
      registerBtn.classList.remove('btn-loading');
      btnText.textContent = 'Daftar Sekarang';
      btnIcon.style.display = 'inline';
    }

    // Check if already logged in
    function checkLoginStatus() {
      const loggedInUser = localStorage.getItem('loggedInUser');
      if (loggedInUser) {
        const user = JSON.parse(loggedInUser);
        if (user.role === 'admin') {
          window.location.href = 'dashboard_admin.html';
        } else {
          window.location.href = 'dashboard_user.html';
        }
      }
    }

    // Initialize on page load
    window.addEventListener('DOMContentLoaded', function() {
      checkLoginStatus();
    });
  </script>
</body>
</html>
